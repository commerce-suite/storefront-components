import{r as t,c as e,h as r,g as o,H as c}from"./p-95925ffd.js";import{F as a}from"./p-8f23dbdc.js";import"./p-6b5b706d.js";var i;(function(t){t["SHOULD_HIDDEN"]="SHOULD_HIDDEN";t["SHOULD_SHOW"]="SHOULD_SHOW"})(i||(i={}));const s='*.sc-buy-together{--fc-font-family:var(--m-ff);--fc-border-radius:4px;--fc-color-primary:var(--color-primary, #ff4295);--fc-color-secondary:var(--color-secondary, #000);--fc-color-white:var(--white, #fff);--fc-m-tt:var(--m-tt, "uppercase");--fc-m-fs:var(--m-fs, 14px);--fc-m-fw:var(--m-fw, 600);--fc-m-ls:var(--m-ls, 1px);--fc-h2-fs:var(--h2-fs, 18px);--fc-h2-fw:var(--h2-fw, 600);--fc-h2-ls:var(--h2-ls, 0px);--fc-color-light-text-default:#343a40;--fc-color-light-text-secondary:#6d747a;--fc-color-light-border-default:#dee2e6;--fc-gap-grid:24px;--fc-margin-width:8px}*.sc-buy-together{--fc-font-family:var(--m-ff);--fc-border-radius:4px;--fc-color-primary:var(--color-primary, #ff4295);--fc-color-secondary:var(--color-secondary, #000);--fc-color-white:var(--white, #fff);--fc-m-tt:var(--m-tt, "uppercase");--fc-m-fs:var(--m-fs, 14px);--fc-m-fw:var(--m-fw, 600);--fc-m-ls:var(--m-ls, 1px);--fc-h2-fs:var(--h2-fs, 18px);--fc-h2-fw:var(--h2-fw, 600);--fc-h2-ls:var(--h2-ls, 0px);--fc-color-light-text-default:#343a40;--fc-color-light-text-secondary:#6d747a;--fc-color-light-border-default:#dee2e6;--fc-gap-grid:24px;--fc-margin-width:8px}*.sc-buy-together{--fc-font-family:var(--m-ff);--fc-border-radius:4px;--fc-color-primary:var(--color-primary, #ff4295);--fc-color-secondary:var(--color-secondary, #000);--fc-color-white:var(--white, #fff);--fc-m-tt:var(--m-tt, "uppercase");--fc-m-fs:var(--m-fs, 14px);--fc-m-fw:var(--m-fw, 600);--fc-m-ls:var(--m-ls, 1px);--fc-h2-fs:var(--h2-fs, 18px);--fc-h2-fw:var(--h2-fw, 600);--fc-h2-ls:var(--h2-ls, 0px);--fc-color-light-text-default:#343a40;--fc-color-light-text-secondary:#6d747a;--fc-color-light-border-default:#dee2e6;--fc-gap-grid:24px;--fc-margin-width:8px}@keyframes lds-dual-ring-animation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}.sc-buy-together-h{display:inline-block;width:100%}.title-wrapper.sc-buy-together{display:flex;align-items:center;justify-content:center}.title-wrapper.sc-buy-together .title.sc-buy-together{font-weight:var(--fc-h2-fw);font-size:var(--fc-h2-fs);margin:56px 0 56px 0}.title-wrapper.sc-buy-together .title.-showcase.sc-buy-together{margin:0 0 24px 0}.loading-container.sc-buy-together{display:flex;width:100%;justify-content:center;align-items:center;min-height:450px}.loading-container.sc-buy-together .spinner.sc-buy-together{--spinner-color:var(--fc-color-secondary, #000);display:inline-block;width:80px;height:80px}.loading-container.sc-buy-together .spinner.sc-buy-together:after{content:" ";display:block;width:64px;height:64px;margin:8px;border-radius:50%;border:6px solid var(--spinner-color);border-color:var(--spinner-color) transparent var(--spinner-color) transparent;animation:lds-dual-ring-animation 1.2s linear infinite}.buy-together-container.sc-buy-together{display:grid;gap:var(--fc-gap-grid);justify-items:center;grid-template-columns:auto;grid-template-rows:auto auto auto auto;grid-template-areas:"main" "plus" "products" "btn-buy"}.buy-together-container.-showcase.sc-buy-together{grid-template-areas:"products" "btn-buy";grid-template-columns:auto;grid-template-rows:auto auto}@media (min-width: 1024px){.buy-together-container.sc-buy-together{grid-template-columns:auto auto auto;grid-template-rows:auto;align-items:center;grid-template-areas:"main plus products btn-buy"}.buy-together-container.-showcase.sc-buy-together{display:flex;flex-direction:column;gap:var(--fc-gap-grid);align-items:center}}.product-wrapper.sc-buy-together{display:flex;width:100%;background-color:var(--fc-color-white);flex-direction:column;padding:calc(var(--fc-margin-width) * 2);border:1px solid var(--fc-color-light-border-default);gap:16px}.product-wrapper.sc-buy-together .checkbox-wrapper.sc-buy-together{margin:5px}.product-wrapper.sc-buy-together .checkbox-wrapper.sc-buy-together input[type=checkbox].sc-buy-together{--form-control-color:var(--fc-color-primary);--form-control-disabled:var(--fc-color-light-text-secondary);appearance:none;background-color:#fff;margin:0;font:inherit;color:var(--form-control-color);width:18px;height:18px;border:1px solid var(--form-control-color);border-radius:var(--fc-border-radius);transform:translateY(-0.075em);display:grid;place-content:center}.product-wrapper.sc-buy-together .checkbox-wrapper.sc-buy-together input[type=checkbox].sc-buy-together:checked{background-color:var(--form-control-color)}.product-wrapper.sc-buy-together .checkbox-wrapper.sc-buy-together input[type=checkbox].sc-buy-together::before{content:"";width:0.65em;height:0.65em;transform:scale(0);background-color:var(--fc-color-white);clip-path:polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%)}.product-wrapper.sc-buy-together .checkbox-wrapper.sc-buy-together input[type=checkbox].sc-buy-together:checked::before{transform:scale(1)}.product-wrapper.sc-buy-together .checkbox-wrapper.sc-buy-together input[type=checkbox].sc-buy-together:disabled{--form-control-color:var(--form-control-disabled);color:var(--form-control-disabled);cursor:not-allowed}.product-wrapper-pivot.sc-buy-together{display:flex;gap:24px;align-items:center}@media (min-width: 1024px){.product-wrapper.sc-buy-together{gap:24px}}.product-main.sc-buy-together{display:flex;grid-area:main;width:100%}.products-order-bump.sc-buy-together{display:flex;width:100%;flex-direction:column;justify-content:center;gap:var(--fc-gap-grid);grid-area:products;align-items:center}@media (min-width: 1024px){.products-order-bump.-showcase.sc-buy-together{flex-direction:row;width:auto;align-items:flex-start}}.plus-icon.sc-buy-together{display:inline-block;grid-area:plus;align-self:center}.buy-btn-wrapper.sc-buy-together{display:flex;grid-area:btn-buy;width:100%}@media (min-width: 1024px){.buy-btn-wrapper.-showcase.sc-buy-together{width:auto}}.buy-btn-wrapper.sc-buy-together .buy-btn.sc-buy-together{--btn-bg-color:var(--fc-color-primary);--btn-text-color:var(--fc-color-white);--btn-text-weight:var(--fc-m-fw, 600);--btn-text-size:var(--fc-m-fs);--btn-text-transform:var(--fc-m-tt, "uppercase");--btn-text-letter-spacing:var(--fc-m-ls, 1px);all:unset;box-sizing:border-box;width:100%;background-color:var(--btn-bg-color);color:var(--btn-text-color);font-weight:var(--btn-text-weight);font-size:var(--btn-text-size);padding:12px 24px;cursor:pointer;border-radius:var(--fc-border-radius);text-align:center;text-transform:var(--btn-text-transform);letter-spacing:var(--btn-text-letter-spacing);--btn-bg-color:var(--color-buy-button);--btn-text-color:var(--color-buy-button-text)}.buy-btn-wrapper.sc-buy-together .buy-btn.sc-buy-together:hover{opacity:0.75}.buy-btn-wrapper.sc-buy-together .buy-btn.sc-buy-together:disabled{opacity:0.6;cursor:not-allowed}';const n=s;const d=class{constructor(r){t(this,r);this.onBuyTogetherAddCartEvent=e(this,"on-buy-together-add-cart",7);this.loadBuyTogehter=e(this,"loadBuyTogehter",7);this.buyTogetherService=new a;this.productId=undefined;this.variationId=undefined;this.promotionTitle=undefined;this.buyButtonText=undefined;this.showcaseMode=undefined;this.buyTogetherData=undefined;this.hasBuyTogether=undefined;this.isLoading=undefined;this.isAddingToCart=undefined;this.formIsValid=undefined}async getBuyTogetherData(){return this.buyTogetherData}async load(){var t;this.isLoading=true;try{this.buyTogetherData=await this.buyTogetherService.getBuyTogetherByProductId(this.productId,this.variationId)}catch(e){if(!((t=e===null||e===void 0?void 0:e.message)===null||t===void 0?void 0:t.includes("buy_together_not_found"))){console.error("BuyTogether - load",{error:e})}}finally{this.isLoading=false;this.emitOnLoad()}}checkValidForm(){const t=t=>t.every((({currentValue:t})=>t!==undefined&&t!==null));const e=t(this.buyTogetherData.productMain.selectVariations);const r=this.buyTogetherData.products.map((({selectVariations:t,isCheck:e})=>({selectVariations:t,isCheck:e}))).filter((({isCheck:t})=>t));const o=r.every((({selectVariations:e})=>t(e)));if(this.showcaseMode){this.formIsValid=o&&r.length>0}else{this.formIsValid=e&&o&&r.length>0}}emitOnLoad(){let t=i.SHOULD_SHOW;if(!this.buyTogetherData){t=i.SHOULD_HIDDEN}this.loadBuyTogehter.emit({status:t,data:this.buyTogetherData})}selectOrderBump(t,e){const{products:r}=this.buyTogetherData;this.buyTogetherData=Object.assign(Object.assign({},this.buyTogetherData),{products:r.map((r=>{if(e===r.id){return Object.assign(Object.assign({},r),{isCheck:t.target.checked})}return r}))})}onInputSelectProductMain(t){const{productCard:e,productTargetUpdated:r}=this.buyTogetherService.changeProductOptions(t.detail,this.buyTogetherData.originalData.product);if(!e)return;this.buyTogetherData=Object.assign(Object.assign({},this.buyTogetherData),{productMain:e,originalData:Object.assign(Object.assign({},this.buyTogetherData.originalData),{product:r})})}resetAttributes(t,e){t.selectVariations.forEach((t=>{if(e==="color"){if(t.selectType==="attributes"||t.selectType==="secondaryAttributes"){t.currentValue=undefined}}if(e==="attributes"){if(t.selectType!=="color"&&t.selectType==="secondaryAttributes"){t.currentValue=undefined}}}))}onInputSelectOrderBump(t){const{productId:e}=t.detail;const{originalData:{productsPivot:r},products:o}=this.buyTogetherData;const c=r.findIndex((({id:t})=>+t===e));const a=o.findIndex((({id:t})=>+t===e));if(c===-1||a===-1)return;const{productCard:i,productTargetUpdated:s}=this.buyTogetherService.changeProductOptions(t.detail,r[c]);r[c]=s;o[a]=Object.assign(Object.assign({},i),{isCheck:o[a].isCheck});if(o[a]){this.resetAttributes(o[a],t.detail.eventSelectType)}this.buyTogetherData=Object.assign(Object.assign({},this.buyTogetherData),{products:o,originalData:Object.assign(Object.assign({},this.buyTogetherData.originalData),{productsPivot:r})})}async onAddItemsToCart(t){try{this.isAddingToCart=true;t.preventDefault();const e=[];const r=this.buyTogetherData.products.filter((t=>t.isCheck));if(!this.showcaseMode)e.push(this.buyTogetherData.productMain.id);r.forEach((t=>e.push(t.id)));await this.buyTogetherService.addToCart(e);this.onBuyTogetherAddCartEvent.emit({showcaseMode:!!this.showcaseMode,productsAdded:[...r,this.buyTogetherData.productMain]})}finally{this.isAddingToCart=false}}showcaseModeClass(){if(this.showcaseMode)return"-showcase";else return""}onClickBuyButtonHandler(t){window.open(`${window.location.origin}/${t.detail.slug}`,"_blank")}watchPropHandler(t){this.hasBuyTogether=!!(t===null||t===void 0?void 0:t.originalData);this.checkValidForm()}watchVariationIdChange(){this.load()}watchProductIdChange(){this.load()}componentWillLoad(){this.load()}render(){return r(c,{key:"e93bb257d558b5dd86624588b46249f088e4795c"},this.isLoading&&r("div",{key:"38c1a4fa630b8ab84dcfccdeacd01217e5da003b",class:"loading-container"},r("span",{key:"16bdf5fb7300be173a6330d39e3fdda065a54f89",class:"spinner"})),!this.isLoading&&this.hasBuyTogether&&r("form",{key:"21792f53904673fa824a912f5dc7a3e81156a42f",onSubmit:t=>this.onAddItemsToCart(t)},r("div",{key:"a239669b9857ff857252beffc076eda548fd8354",class:"title-wrapper"},r("h2",{key:"919657904f77f2a040f2a34885c8f6e554a0ea70",class:`title ${this.showcaseModeClass()}`},this.promotionTitle||"Compre Junto")),r("section",{key:"b2a5b9ccbd22044228f83ce216f86e75ed234c8c",class:`bagy-buy-together buy-together-container ${this.showcaseModeClass()}`},!this.showcaseMode&&r("div",{key:"3a42ed646eef6f59cf3bde40d3a452c6e3406fb7",class:"product-main"},r("div",{key:"2cb95cc72c4e796d4b7fc1d9652a574fc229cf4b",class:"product-wrapper"},r("product-card",{key:"73fb1f4a765258edb8235e7d4c07be14f4f7bfd2",product:this.buyTogetherData.productMain,paymentOptions:this.buyTogetherData.productMain.paymentOptions}),this.buyTogetherData.productMain.selectVariations&&r("variation-selector",{key:"cdee4a1b28f10d993f66fe5e2e0ab98ff9c7325c",productId:this.buyTogetherData.productMain.id,onInputSelect:t=>this.onInputSelectProductMain(t),variations:this.buyTogetherData.productMain.selectVariations}))),!this.showcaseMode&&r("div",{key:"e55a96cfb6f5648a6388fa301b2379847389a66a",class:"plus-icon"},r("img",{key:"670ffd7c815d412e03104e35a7a47e614da7736c",src:o("./assets/icons/icon-plus.svg"),alt:""})),r("div",{key:"5c3c4822b4d8500c6527df394a8dfe097792c243",class:`products-order-bump ${this.showcaseModeClass()}`},this.buyTogetherData.products.map((t=>r("div",{class:"product-wrapper"},r("div",{class:"product-wrapper-pivot"},r("div",{class:"checkbox-wrapper"},r("input",{type:"checkbox",checked:t.isCheck,id:String(t.id),onInput:e=>this.selectOrderBump(e,t.id)})),r("product-card",{inline:true,product:t,paymentOptions:t.paymentOptions})),t.selectVariations&&r("variation-selector",{productId:t.id,variations:t.selectVariations,onInputSelect:t=>this.onInputSelectOrderBump(t),showcaseMode:this.showcaseMode}))))),r("div",{key:"a2be41750ca174b9efccaea6e4072aa8ee656d16",class:`buy-btn-wrapper ${this.showcaseModeClass()}`},r("button",{key:"887cefe57bb720b493e11a78a7f0c8b9b81da5dd",class:"buy-btn",type:"submit",disabled:this.isAddingToCart||!this.formIsValid},this.buyButtonText||"Comprar")))))}static get watchers(){return{buyTogetherData:["watchPropHandler"],variationId:["watchVariationIdChange"],productId:["watchProductIdChange"]}}};d.style=n;export{d as buy_together};
//# sourceMappingURL=p-911f0f81.entry.js.map