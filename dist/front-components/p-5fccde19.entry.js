import{r as c,h as s,g as t,H as a}from"./p-bc241129.js";import{c as i}from"./p-1f38ea7b.js";const n=(c,s,t)=>new Promise(((a,i)=>{const n=new XMLHttpRequest;n.open(c,s,true);n.setRequestHeader("X-Ajax","true");n.setRequestHeader("Content-Type","application/json");n.onload=function(){if(n.status>=200&&n.status<300){a(JSON.parse(n.responseText))}else{i(n.status)}};n.send(t?JSON.stringify(t):null)}));const e={async calculate(c){return await n("POST",`${window.dooca.base_url}/action/promotions/calculate`,c)}};var o;(function(c){c["CASHBACK_CREDIT"]="cashback_credit";c["CASHBACK_DEBIT"]="cashback_debit"})(o||(o={}));const r=".cashback.sc-cashback-credit{display:inline-flex}.cashback.sc-cashback-credit img.sc-cashback-credit{margin-right:0.5rem}.cashback.sc-cashback-credit span.sc-cashback-credit{color:var(--success)}";const d=r;const h=class{constructor(s){c(this,s);this.customer_id=undefined;this.cashback=undefined;this.product=undefined;this.credit=undefined}async componentWillLoad(){await this.getCalculation()}async onCustomerIdChange(){await this.getCalculation()}async onProductChange(){await this.getCalculation()}async getCalculation(){var c;const s=this.cashback&&this.cashback.active&&this.cashback.show_credit_preview;if(!this.product||!s)return;const{id:t,price:a}=this.product;const i={customer_id:this.customer_id,exclude_promotions:[o.CASHBACK_DEBIT],items:[{id:t,quantity:1,price:a,discount:0}]};const n=await e.calculate(i);const r=c=>o.CASHBACK_CREDIT===c.promotion;this.credit=(c=n.items)===null||c===void 0?void 0:c.find(r)}render(){return s(a,{key:"7a9b5e42944d2dc68c03b8651f8ce4dd921b5f2b"},this.credit&&this.credit.value>0?s("div",{class:"cashback"},s("img",{src:t("./assets/icons/cashback.svg")}),s("span",null,"Na compra deste produto, você receberá até"," ",s("strong",null,i(this.credit.value))," em Cashback!")):null)}static get watchers(){return{customer_id:["onCustomerIdChange"],product:["onProductChange"]}}};h.style=d;export{h as cashback_credit};
//# sourceMappingURL=p-5fccde19.entry.js.map