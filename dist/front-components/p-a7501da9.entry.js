import{r as s,h as c,a as t,H as a}from"./p-6b3a223d.js";import{c as i}from"./p-f0378ed9.js";const n=(s,c,t)=>new Promise(((a,i)=>{const n=new XMLHttpRequest;n.open(s,c,true);n.setRequestHeader("X-Ajax","true");n.setRequestHeader("Content-Type","application/json");n.onload=function(){if(n.status>=200&&n.status<300){a(JSON.parse(n.responseText))}else{i(n.status)}};n.send(t?JSON.stringify(t):null)}));const e={async calculate(s){return await n("POST",`${window.dooca.base_url}/action/promotions/calculate`,s)}};var o;(function(s){s["CASHBACK_CREDIT"]="cashback_credit";s["CASHBACK_DEBIT"]="cashback_debit"})(o||(o={}));const r=".cashback.sc-cashback-credit{display:inline-flex}.cashback.sc-cashback-credit img.sc-cashback-credit{margin-right:0.5rem}.cashback.sc-cashback-credit span.sc-cashback-credit{color:var(--success)}";const d=r;const h=class{constructor(c){s(this,c);this.customer_id=undefined;this.cashback=undefined;this.product=undefined;this.credit=undefined}async componentWillLoad(){await this.getCalculation()}async onCustomerIdChange(){await this.getCalculation()}async onProductChange(){await this.getCalculation()}async getCalculation(){var s;const c=this.cashback&&this.cashback.active&&this.cashback.show_credit_preview;if(!this.product||!c)return;const{id:t,price:a}=this.product;const i={customer_id:this.customer_id,exclude_promotions:[o.CASHBACK_DEBIT],items:[{id:t,quantity:1,price:a,discount:0}]};const n=await e.calculate(i);const r=s=>o.CASHBACK_CREDIT===s.promotion;this.credit=(s=n.items)===null||s===void 0?void 0:s.find(r)}render(){return c(a,{key:"7a9b5e42944d2dc68c03b8651f8ce4dd921b5f2b"},this.credit&&this.credit.value>0?c("div",{class:"cashback"},c("img",{src:t("./assets/icons/cashback.svg")}),c("span",null,"Na compra deste produto, você receberá até"," ",c("strong",null,i(this.credit.value))," em Cashback!")):null)}static get watchers(){return{customer_id:["onCustomerIdChange"],product:["onProductChange"]}}};h.style=d;export{h as cashback_credit};
//# sourceMappingURL=p-a7501da9.entry.js.map