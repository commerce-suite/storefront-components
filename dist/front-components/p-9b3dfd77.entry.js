import{r as t,c as e,h as r,g as o,H as c}from"./p-bc241129.js";import{F as a}from"./p-404e22b8.js";import"./p-125a210c.js";var i;(function(t){t["SHOULD_HIDDEN"]="SHOULD_HIDDEN";t["SHOULD_SHOW"]="SHOULD_SHOW"})(i||(i={}));const s='*.sc-buy-together{--fc-font-family:var(--m-ff);--fc-border-radius:4px;--fc-color-primary:var(--color-primary, #ff4295);--fc-color-secondary:var(--color-secondary, #000);--fc-color-white:var(--white, #fff);--fc-m-tt:var(--m-tt, "uppercase");--fc-m-fs:var(--m-fs, 14px);--fc-m-fw:var(--m-fw, 600);--fc-m-ls:var(--m-ls, 1px);--fc-h2-fs:var(--h2-fs, 18px);--fc-h2-fw:var(--h2-fw, 600);--fc-h2-ls:var(--h2-ls, 0px);--fc-color-light-text-default:#343a40;--fc-color-light-text-secondary:#6d747a;--fc-color-light-border-default:#dee2e6;--fc-gap-grid:24px;--fc-margin-width:8px}*.sc-buy-together{--fc-font-family:var(--m-ff);--fc-border-radius:4px;--fc-color-primary:var(--color-primary, #ff4295);--fc-color-secondary:var(--color-secondary, #000);--fc-color-white:var(--white, #fff);--fc-m-tt:var(--m-tt, "uppercase");--fc-m-fs:var(--m-fs, 14px);--fc-m-fw:var(--m-fw, 600);--fc-m-ls:var(--m-ls, 1px);--fc-h2-fs:var(--h2-fs, 18px);--fc-h2-fw:var(--h2-fw, 600);--fc-h2-ls:var(--h2-ls, 0px);--fc-color-light-text-default:#343a40;--fc-color-light-text-secondary:#6d747a;--fc-color-light-border-default:#dee2e6;--fc-gap-grid:24px;--fc-margin-width:8px}*.sc-buy-together{--fc-font-family:var(--m-ff);--fc-border-radius:4px;--fc-color-primary:var(--color-primary, #ff4295);--fc-color-secondary:var(--color-secondary, #000);--fc-color-white:var(--white, #fff);--fc-m-tt:var(--m-tt, "uppercase");--fc-m-fs:var(--m-fs, 14px);--fc-m-fw:var(--m-fw, 600);--fc-m-ls:var(--m-ls, 1px);--fc-h2-fs:var(--h2-fs, 18px);--fc-h2-fw:var(--h2-fw, 600);--fc-h2-ls:var(--h2-ls, 0px);--fc-color-light-text-default:#343a40;--fc-color-light-text-secondary:#6d747a;--fc-color-light-border-default:#dee2e6;--fc-gap-grid:24px;--fc-margin-width:8px}@keyframes lds-dual-ring-animation{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes simple-spinner-animation{0%{transform:translate(-50%, -50%) rotate(0deg)}100%{transform:translate(-50%, -50%) rotate(360deg)}}.sc-buy-together-h{display:inline-block;width:100%}.title-wrapper.sc-buy-together{display:flex;align-items:center;justify-content:center}.title-wrapper.sc-buy-together .title.sc-buy-together{font-weight:var(--fc-h2-fw);font-size:var(--fc-h2-fs);margin:56px 0 56px 0}.title-wrapper.sc-buy-together .title.-showcase.sc-buy-together{margin:0 0 24px 0}.loading-container.sc-buy-together{display:flex;width:100%;justify-content:center;align-items:center;min-height:450px}.loading-container.sc-buy-together .spinner.sc-buy-together{--spinner-color:var(--fc-color-secondary, #000);display:inline-block;width:80px;height:80px}.loading-container.sc-buy-together .spinner.sc-buy-together:after{content:" ";display:block;width:64px;height:64px;margin:8px;border-radius:50%;border:6px solid var(--spinner-color);border-color:var(--spinner-color) transparent var(--spinner-color) transparent;animation:lds-dual-ring-animation 1.2s linear infinite}.buy-together-container.sc-buy-together{display:grid;gap:var(--fc-gap-grid);justify-items:center;grid-template-columns:auto;grid-template-rows:auto auto auto auto;grid-template-areas:"main" "plus" "products" "btn-buy"}.buy-together-container.-showcase.sc-buy-together{grid-template-areas:"products" "btn-buy";grid-template-columns:auto;grid-template-rows:auto auto}@media (min-width: 1024px){.buy-together-container.sc-buy-together{grid-template-columns:auto auto auto;grid-template-rows:auto;align-items:center;grid-template-areas:"main plus products btn-buy"}.buy-together-container.-showcase.sc-buy-together{display:flex;flex-direction:column;gap:var(--fc-gap-grid);align-items:center}}.product-wrapper.sc-buy-together{display:flex;width:100%;background-color:var(--fc-color-white);flex-direction:column;padding:calc(var(--fc-margin-width) * 2);border:1px solid var(--fc-color-light-border-default);gap:16px}.product-wrapper.sc-buy-together .checkbox-wrapper.sc-buy-together{margin:5px}.product-wrapper.sc-buy-together .checkbox-wrapper.sc-buy-together input[type=checkbox].sc-buy-together{--form-control-color:var(--fc-color-primary);--form-control-disabled:var(--fc-color-light-text-secondary);appearance:none;background-color:#fff;margin:0;font:inherit;color:var(--form-control-color);width:18px;height:18px;border:1px solid var(--form-control-color);border-radius:var(--fc-border-radius);transform:translateY(-0.075em);display:grid;place-content:center}.product-wrapper.sc-buy-together .checkbox-wrapper.sc-buy-together input[type=checkbox].sc-buy-together:checked{background-color:var(--form-control-color)}.product-wrapper.sc-buy-together .checkbox-wrapper.sc-buy-together input[type=checkbox].sc-buy-together::before{content:"";width:0.65em;height:0.65em;transform:scale(0);background-color:var(--fc-color-white);clip-path:polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%)}.product-wrapper.sc-buy-together .checkbox-wrapper.sc-buy-together input[type=checkbox].sc-buy-together:checked::before{transform:scale(1)}.product-wrapper.sc-buy-together .checkbox-wrapper.sc-buy-together input[type=checkbox].sc-buy-together:disabled{--form-control-color:var(--form-control-disabled);color:var(--form-control-disabled);cursor:not-allowed}.product-wrapper-pivot.sc-buy-together{display:flex;gap:24px;align-items:center}@media (min-width: 1024px){.product-wrapper.sc-buy-together{gap:24px}}.product-main.sc-buy-together{display:flex;grid-area:main;width:100%}.products-order-bump.sc-buy-together{display:flex;width:100%;flex-direction:column;justify-content:center;gap:var(--fc-gap-grid);grid-area:products;align-items:center}@media (min-width: 1024px){.products-order-bump.-showcase.sc-buy-together{flex-direction:row;width:auto;align-items:flex-start}}.plus-icon.sc-buy-together{display:inline-block;grid-area:plus;align-self:center}.buy-btn-wrapper.sc-buy-together{display:flex;grid-area:btn-buy;width:100%}@media (min-width: 1024px){.buy-btn-wrapper.-showcase.sc-buy-together{width:auto}}.buy-btn-wrapper.sc-buy-together .buy-btn.sc-buy-together{--btn-bg-color:var(--fc-color-primary);--btn-text-color:var(--fc-color-white);--btn-text-weight:var(--fc-m-fw, 600);--btn-text-size:var(--fc-m-fs);--btn-text-transform:var(--fc-m-tt, "uppercase");--btn-text-letter-spacing:var(--fc-m-ls, 1px);all:unset;box-sizing:border-box;width:100%;background-color:var(--btn-bg-color);color:var(--btn-text-color);font-weight:var(--btn-text-weight);font-size:var(--btn-text-size);padding:12px 24px;cursor:pointer;border-radius:var(--fc-border-radius);text-align:center;text-transform:var(--btn-text-transform);letter-spacing:var(--btn-text-letter-spacing);--btn-bg-color:var(--color-buy-button);--btn-text-color:var(--color-buy-button-text)}.buy-btn-wrapper.sc-buy-together .buy-btn.sc-buy-together:hover{opacity:0.75}.buy-btn-wrapper.sc-buy-together .buy-btn.sc-buy-together:disabled{opacity:0.6;cursor:not-allowed}';const n=s;const d=class{constructor(r){t(this,r);this.onBuyTogetherAddCartEvent=e(this,"on-buy-together-add-cart",7);this.loadBuyTogehter=e(this,"loadBuyTogehter",7);this.buyTogetherService=new a;this.productId=undefined;this.variationId=undefined;this.promotionTitle=undefined;this.buyButtonText=undefined;this.showcaseMode=undefined;this.buyTogetherData=undefined;this.hasBuyTogether=undefined;this.isLoading=undefined;this.isAddingToCart=undefined;this.formIsValid=undefined}async getBuyTogetherData(){return this.buyTogetherData}async load(){var t;this.isLoading=true;try{this.buyTogetherData=await this.buyTogetherService.getBuyTogetherByProductId(this.productId,this.variationId)}catch(e){if(!((t=e===null||e===void 0?void 0:e.message)===null||t===void 0?void 0:t.includes("buy_together_not_found"))){console.error("BuyTogether - load",{error:e})}}finally{this.isLoading=false;this.emitOnLoad()}}checkValidForm(){var t,e;const r=t=>t===null||t===void 0?void 0:t.every((({currentValue:t})=>t!==undefined&&t!==null));const o=r((t=this.buyTogetherData)===null||t===void 0?void 0:t.productMain.selectVariations);const c=(e=this.buyTogetherData)===null||e===void 0?void 0:e.products.map((({selectVariations:t,isCheck:e})=>({selectVariations:t,isCheck:e}))).filter((({isCheck:t})=>t));const a=c===null||c===void 0?void 0:c.every((({selectVariations:t})=>r(t)));if(this.showcaseMode){this.formIsValid=a&&c.length>0}else{this.formIsValid=o&&a&&c.length>0}}emitOnLoad(){let t=i.SHOULD_SHOW;if(!this.buyTogetherData){t=i.SHOULD_HIDDEN}this.loadBuyTogehter.emit({status:t,data:this.buyTogetherData})}selectOrderBump(t,e){const{products:r}=this.buyTogetherData;this.buyTogetherData=Object.assign(Object.assign({},this.buyTogetherData),{products:r.map((r=>{if(e===r.id){return Object.assign(Object.assign({},r),{isCheck:t.target.checked})}return r}))})}onInputSelectProductMain(t){const{productCard:e,productTargetUpdated:r}=this.buyTogetherService.changeProductOptions(t.detail,this.buyTogetherData.originalData.product);if(!e)return;this.buyTogetherData=Object.assign(Object.assign({},this.buyTogetherData),{productMain:e,originalData:Object.assign(Object.assign({},this.buyTogetherData.originalData),{product:r})})}resetAttributes(t,e){t.selectVariations.forEach((t=>{if(e==="color"){if(t.selectType==="attributes"||t.selectType==="secondaryAttributes"){t.currentValue=undefined}}if(e==="attributes"){if(t.selectType!=="color"&&t.selectType==="secondaryAttributes"){t.currentValue=undefined}}}))}onInputSelectOrderBump(t){const{productId:e}=t.detail;const{originalData:{productsPivot:r},products:o}=this.buyTogetherData;const c=r.findIndex((({id:t})=>+t===e));const a=o.findIndex((({id:t})=>+t===e));if(c===-1||a===-1)return;const{productCard:i,productTargetUpdated:s}=this.buyTogetherService.changeProductOptions(t.detail,r[c]);r[c]=s;o[a]=Object.assign(Object.assign({},i),{isCheck:o[a].isCheck});if(o[a]){this.resetAttributes(o[a],t.detail.eventSelectType)}this.buyTogetherData=Object.assign(Object.assign({},this.buyTogetherData),{products:o,originalData:Object.assign(Object.assign({},this.buyTogetherData.originalData),{productsPivot:r})})}async onAddItemsToCart(t){try{this.isAddingToCart=true;t.preventDefault();const e=[];const r=this.buyTogetherData.products.filter((t=>t.isCheck));if(!this.showcaseMode)e.push(this.buyTogetherData.productMain.id);r.forEach((t=>e.push(t.id)));await this.buyTogetherService.addToCart(e);this.onBuyTogetherAddCartEvent.emit({showcaseMode:!!this.showcaseMode,productsAdded:[...r,this.buyTogetherData.productMain]})}finally{this.isAddingToCart=false}}showcaseModeClass(){if(this.showcaseMode)return"-showcase";else return""}onClickBuyButtonHandler(t){window.open(`${window.location.origin}/${t.detail.slug}`,"_blank")}watchPropHandler(t){this.hasBuyTogether=!!(t===null||t===void 0?void 0:t.originalData);this.checkValidForm()}watchVariationIdChange(){this.load()}watchProductIdChange(){this.load()}componentWillLoad(){this.load()}render(){return r(c,{key:"50d0577a7bae71964d87c0fba49add6027bdc1f9"},this.isLoading&&r("div",{key:"ea2bb5013e6ed9f7c099288b7ef459c542ebc00b",class:"loading-container"},r("span",{key:"fd5b91847f76da5ebda1a4933aea65c5e3783e2f",class:"spinner"})),!this.isLoading&&this.hasBuyTogether&&r("form",{key:"af8349bed74fb8c7bba35089ccc1cc66584ba9eb",onSubmit:t=>this.onAddItemsToCart(t)},r("div",{key:"2822538a4a0d28fced907e94c0c23b7ac1684439",class:"title-wrapper"},r("h2",{key:"d6b8c3e81a7a31fde0f20dc65f47a68d530301f9",class:`title ${this.showcaseModeClass()}`},this.promotionTitle||"Compre Junto")),r("section",{key:"24ff30029ceb36fd66f705827ea5cd17fbc19460",class:`bagy-buy-together buy-together-container ${this.showcaseModeClass()}`},!this.showcaseMode&&r("div",{key:"69681b0b617cfb65dbe04beeae7f87bf8f63cae1",class:"product-main"},r("div",{key:"85d34d30c3c6b1ee53f5d000ec222cffadc19819",class:"product-wrapper"},r("product-card",{key:"74c3143d77db36527669a85b7d1f8530c5f0ca67",product:this.buyTogetherData.productMain,paymentOptions:this.buyTogetherData.productMain.paymentOptions}),this.buyTogetherData.productMain.selectVariations&&r("variation-selector",{key:"266bdf9a13b2286efe046b02780af8ac66bedb59",productId:this.buyTogetherData.productMain.id,onInputSelect:t=>this.onInputSelectProductMain(t),variations:this.buyTogetherData.productMain.selectVariations}))),!this.showcaseMode&&r("div",{key:"47ba67f467c95d11ab27e8bd26c882a2cde5e093",class:"plus-icon"},r("img",{key:"aedda567295263226b32cc14da035f2e0202aa26",src:o("./assets/icons/icon-plus.svg"),alt:""})),r("div",{key:"7f9bfff55456a61c8d4d3ac063c637dfd2ec74ca",class:`products-order-bump ${this.showcaseModeClass()}`},this.buyTogetherData.products.map((t=>r("div",{class:"product-wrapper"},r("div",{class:"product-wrapper-pivot"},r("div",{class:"checkbox-wrapper"},r("input",{type:"checkbox",checked:t.isCheck,id:String(t.id),onInput:e=>this.selectOrderBump(e,t.id)})),r("product-card",{inline:true,product:t,paymentOptions:t.paymentOptions})),t.selectVariations&&r("variation-selector",{productId:t.id,variations:t.selectVariations,onInputSelect:t=>this.onInputSelectOrderBump(t),showcaseMode:this.showcaseMode}))))),r("div",{key:"a78d4903e53653446acc8ebd5f74de5de6b39b43",class:`buy-btn-wrapper ${this.showcaseModeClass()}`},r("button",{key:"4ed9fcb85eae4641d8ad2b99ab8bab305e0a6124",class:"buy-btn",type:"submit",disabled:this.isAddingToCart||!this.formIsValid},this.buyButtonText||"Comprar")))))}static get watchers(){return{buyTogetherData:["watchPropHandler"],variationId:["watchVariationIdChange"],productId:["watchProductIdChange"]}}};d.style=n;export{d as buy_together};
//# sourceMappingURL=p-9b3dfd77.entry.js.map