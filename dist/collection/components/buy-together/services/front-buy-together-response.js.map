{"version":3,"file":"front-buy-together-response.js","sourceRoot":"","sources":["../../../../../src/components/buy-together/services/front-buy-together-response.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,uBAAuB,EAAE,MAAM,8BAA8B,CAAC;AAGvE,MAAM,OAAO,wBAAwB;IAInC,YAAY,QAAqB;QAC/B,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;IAC3B,CAAC;IAEM,sBAAsB;;QAC3B,MAAM,eAAe,GAAG,IAAI,CAAC,QAAQ,IAAI,CAAA,MAAA,MAAA,IAAI,CAAC,QAAQ,0CAAE,aAAa,0CAAE,MAAM,IAAG,CAAC,CAAC;QAClF,IAAI,CAAC,aAAa,GAAG,eAAe;YAClC,CAAC,CAAC,uBAAuB,CAAC,kCAAkC,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC;YACjF,CAAC,CAAC,IAAI,CAAC;QACT,OAAO,IAAI,CAAC;IACd,CAAC;IAEM,yBAAyB,CAAC,WAAoB;;QACnD,IAAI,CAAC,WAAW;YAAE,OAAO,IAAI,CAAC;QAC9B,MAAM,SAAS,GAAG,MAAA,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAU,0CAAE,IAAI,CACtD,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,MAAM,CAAC,EAAE,CAAC,KAAK,WAAW,CACvC,CAAC;QACF,IAAI,CAAC,SAAS;YAAE,OAAO,IAAI,CAAC;QAE5B,IAAI,CAAA,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,OAAO,IAAG,CAAC,EAAE,CAAC;YAC3B,IAAI,CAAC,QAAQ,CAAC,OAAO,mCAChB,SAAS,KACZ,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAU,GAC7C,CAAC;QACJ,CAAC;QAED,MAAM,oBAAoB,GAAG,MAAA,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAU,0CAAE,IAAI,CACjE,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,gBAAgB,EAAE,EAAE,EAAE;YACvC,IAAI,SAAS,CAAC,KAAK,EAAE,CAAC;gBACpB,OAAO,SAAS,CAAC,KAAK,CAAC,EAAE,KAAK,KAAK,CAAC,EAAE,IAAI,CAAC,OAAO,GAAG,CAAC,IAAI,gBAAgB,CAAC,CAAC;YAC9E,CAAC;YACD,OAAO,OAAO,GAAG,CAAC,IAAI,gBAAgB,CAAC;QACzC,CAAC,CACF,CAAC;QAEF,IAAI,CAAC,QAAQ,CAAC,OAAO,mCAChB,oBAAoB,KACvB,UAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAU,GAC7C,CAAC;QAEF,OAAO,IAAI,CAAC;IACd,CAAC;IAED,IAAI,gBAAgB;QAClB,OAAO,IAAI,CAAC,aAAa,CAAC;IAC5B,CAAC;IAED,IAAI,WAAW;QACb,OAAO,IAAI,CAAC,QAAQ,CAAC;IACvB,CAAC;CACF","sourcesContent":["import { BuyTogether } from '@uxshop/storefront-core/dist/modules/buy-together/BuyTogetherTypes';\nimport { FrontBuyTogetherAdapter } from './front-buy-together.adapter';\nimport { IBuyTogetherComponentData } from '../buy-together.type';\n\nexport class FrontBuyTogetherResponse {\n  protected response: BuyTogether;\n  protected componentData: IBuyTogetherComponentData | null;\n\n  constructor(response: BuyTogether) {\n    this.response = response;\n  }\n\n  public adapterToComponentData(): FrontBuyTogetherResponse {\n    const canApplyAdapter = this.response && this.response?.productsPivot?.length > 0;\n    this.componentData = canApplyAdapter\n      ? FrontBuyTogetherAdapter.adapterIBuyTogetherToComponentData(this.response, true)\n      : null;\n    return this;\n  }\n\n  public changeByVariationSelected(variationId?: number) {\n    if (!variationId) return this;\n    const variation = this.response.product.variations?.find(\n      ({ id }) => Number(id) === variationId,\n    );\n    if (!variation) return this;\n\n    if (variation?.balance > 0) {\n      this.response.product = {\n        ...variation,\n        variations: this.response.product.variations,\n      };\n    }\n\n    const variationWithBalance = this.response.product.variations?.find(\n      ({ balance, color, isSellOutOfStock }) => {\n        if (variation.color) {\n          return variation.color.id === color.id && (balance > 0 || isSellOutOfStock);\n        }\n        return balance > 0 || isSellOutOfStock;\n      },\n    );\n\n    this.response.product = {\n      ...variationWithBalance,\n      variations: this.response.product.variations,\n    };\n\n    return this;\n  }\n\n  get getComponentData() {\n    return this.componentData;\n  }\n\n  get getResponse() {\n    return this.response;\n  }\n}\n"]}