{"version":3,"file":"buy-together.js","sourceRoot":"","sources":["../../../src/components/buy-together/buy-together.tsx"],"names":[],"mappings":"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","sourcesContent":["import {\n  Component,\n  Host,\n  h,\n  ComponentWillLoad,\n  Prop,\n  State,\n  getAssetPath,\n  Method,\n  Event,\n  EventEmitter,\n  Watch,\n  Listen,\n} from '@stencil/core';\nimport {\n  EnumBuyTogetherOnLoadStatus,\n  IBuyTogetherComponentData,\n  IProductOrderBump,\n} from './buy-together.type';\nimport { FrontBuyTogetherService } from './services/front-buy-together.service';\nimport {\n  IInputSelectDataEvent,\n  IProductCard,\n  ISelectVariation,\n  SelectAttributesType,\n} from '../ui/product-card/product-card.type';\n\n@Component({\n  tag: 'buy-together',\n  styleUrl: 'buy-together.scss',\n  shadow: false,\n  scoped: true,\n})\nexport class BuyTogether implements ComponentWillLoad {\n  @Prop({ mutable: true }) productId: number;\n  @Prop({ mutable: true }) variationId: number;\n  @Prop() promotionTitle: string;\n  @Prop() buyButtonText: string;\n  @Prop() showcaseMode?: boolean;\n  private buyTogetherService = new FrontBuyTogetherService();\n  @State() buyTogetherData: IBuyTogetherComponentData;\n  @Event({ bubbles: true, eventName: 'on-buy-together-add-cart' })\n  onBuyTogetherAddCartEvent: EventEmitter<{ showcaseMode: boolean; productsAdded: IProductCard[] }>;\n\n  @Event({ bubbles: true })\n  loadBuyTogehter: EventEmitter<{\n    status: EnumBuyTogetherOnLoadStatus;\n    data: IBuyTogetherComponentData | null;\n  }>;\n\n  @State() hasBuyTogether: boolean;\n  @State() isLoading: boolean;\n  @State() isAddingToCart: boolean;\n  @State() formIsValid: boolean;\n\n  @Method()\n  async getBuyTogetherData() {\n    return this.buyTogetherData;\n  }\n\n  public async load() {\n    this.isLoading = true;\n    try {\n      this.buyTogetherData = await this.buyTogetherService.getBuyTogetherByProductId(\n        this.productId,\n        this.variationId,\n      );\n    } catch (error) {\n      if (!error?.message?.includes('buy_together_not_found')) {\n        console.error('BuyTogether - load', { error });\n      }\n    } finally {\n      this.isLoading = false;\n      this.emitOnLoad();\n    }\n  }\n\n  private checkValidForm() {\n    const checkSelectedVariations = (variations: ISelectVariation[]) =>\n      variations.every(({ currentValue }) => currentValue !== undefined && currentValue !== null);\n    const isValidProductMain = checkSelectedVariations(\n      this.buyTogetherData.productMain.selectVariations,\n    );\n    const productsPivotSelected = this.buyTogetherData.products\n      .map(({ selectVariations, isCheck }) => ({ selectVariations, isCheck }))\n      .filter(({ isCheck }) => isCheck);\n    const isValidPivotProducts = productsPivotSelected.every(({ selectVariations }) =>\n      checkSelectedVariations(selectVariations),\n    );\n\n    if (this.showcaseMode) {\n      this.formIsValid = isValidPivotProducts && productsPivotSelected.length > 0;\n    } else {\n      this.formIsValid =\n        isValidProductMain && isValidPivotProducts && productsPivotSelected.length > 0;\n    }\n  }\n\n  private emitOnLoad() {\n    let status = EnumBuyTogetherOnLoadStatus.SHOULD_SHOW;\n    if (!this.buyTogetherData) {\n      status = EnumBuyTogetherOnLoadStatus.SHOULD_HIDDEN;\n    }\n    this.loadBuyTogehter.emit({ status, data: this.buyTogetherData });\n  }\n\n  private selectOrderBump(event: any, productOrderBumpId: number) {\n    const { products } = this.buyTogetherData;\n    this.buyTogetherData = {\n      ...this.buyTogetherData,\n      products: products.map(prod => {\n        if (productOrderBumpId === prod.id) {\n          return { ...prod, isCheck: event.target.checked };\n        }\n        return prod;\n      }),\n    };\n  }\n\n  private onInputSelectProductMain(event: CustomEvent<IInputSelectDataEvent>) {\n    const { productCard, productTargetUpdated } = this.buyTogetherService.changeProductOptions(\n      event.detail,\n      this.buyTogetherData.originalData.product,\n    );\n    if (!productCard) return;\n    this.buyTogetherData = {\n      ...this.buyTogetherData,\n      productMain: productCard,\n      originalData: {\n        ...this.buyTogetherData.originalData,\n        product: productTargetUpdated,\n      },\n    };\n  }\n\n  private resetAttributes(product: IProductOrderBump, attributeTypeChanged: SelectAttributesType) {\n    product.selectVariations.forEach(variation => {\n      if (attributeTypeChanged === 'color') {\n        if (\n          variation.selectType === 'attributes' ||\n          variation.selectType === 'secondaryAttributes'\n        ) {\n          variation.currentValue = undefined;\n        }\n      }\n      if (attributeTypeChanged === 'attributes') {\n        if (variation.selectType !== 'color' && variation.selectType === 'secondaryAttributes') {\n          variation.currentValue = undefined;\n        }\n      }\n    });\n  }\n\n  private onInputSelectOrderBump(event: CustomEvent<IInputSelectDataEvent>) {\n    const { productId } = event.detail;\n    const {\n      originalData: { productsPivot },\n      products,\n    } = this.buyTogetherData;\n\n    const productPivotIndex = productsPivot.findIndex(({ id }) => +id === productId);\n    const productIndex = products.findIndex(({ id }) => +id === productId);\n\n    if (productPivotIndex === -1 || productIndex === -1) return;\n\n    const { productCard, productTargetUpdated } = this.buyTogetherService.changeProductOptions(\n      event.detail,\n      productsPivot[productPivotIndex],\n    );\n\n    productsPivot[productPivotIndex] = productTargetUpdated;\n    products[productIndex] = { ...productCard, isCheck: products[productIndex].isCheck };\n\n    if (products[productIndex]) {\n      this.resetAttributes(products[productIndex], event.detail.eventSelectType);\n    }\n\n    this.buyTogetherData = {\n      ...this.buyTogetherData,\n      products,\n      originalData: {\n        ...this.buyTogetherData.originalData,\n        productsPivot,\n      },\n    };\n  }\n\n  private async onAddItemsToCart(event: any) {\n    try {\n      this.isAddingToCart = true;\n      event.preventDefault();\n      const variationsIds: number[] = [];\n      const checkedProducts = this.buyTogetherData.products.filter(product => product.isCheck);\n      if (!this.showcaseMode) variationsIds.push(this.buyTogetherData.productMain.id);\n      checkedProducts.forEach(product => variationsIds.push(product.id));\n      await this.buyTogetherService.addToCart(variationsIds);\n      this.onBuyTogetherAddCartEvent.emit({\n        showcaseMode: !!this.showcaseMode,\n        productsAdded: [...checkedProducts, this.buyTogetherData.productMain],\n      });\n    } finally {\n      this.isAddingToCart = false;\n    }\n  }\n\n  private showcaseModeClass() {\n    if (this.showcaseMode) return '-showcase';\n    else return '';\n  }\n\n  @Listen('clickBuyButton')\n  onClickBuyButtonHandler(event: CustomEvent<IProductCard>) {\n    window.open(`${window.location.origin}/${event.detail.slug}`, '_blank');\n  }\n\n  @Watch('buyTogetherData')\n  watchPropHandler(newValue: IBuyTogetherComponentData) {\n    this.hasBuyTogether = !!newValue?.originalData;\n    this.checkValidForm();\n  }\n\n  @Watch('variationId')\n  watchVariationIdChange() {\n    this.load();\n  }\n\n  @Watch('productId')\n  watchProductIdChange() {\n    this.load();\n  }\n\n  componentWillLoad(): void | Promise<void> {\n    this.load();\n  }\n\n  render() {\n    return (\n      <Host>\n        {this.isLoading && (\n          <div class=\"loading-container\">\n            <span class=\"spinner\" />\n          </div>\n        )}\n        {!this.isLoading && this.hasBuyTogether && (\n          <form onSubmit={evt => this.onAddItemsToCart(evt)}>\n            <div class=\"title-wrapper\">\n              <h2 class={`title ${this.showcaseModeClass()}`}>\n                {this.promotionTitle || 'Compre Junto'}\n              </h2>\n            </div>\n            <section class={`bagy-buy-together buy-together-container ${this.showcaseModeClass()}`}>\n              {!this.showcaseMode && (\n                <div class=\"product-main\">\n                  <div class=\"product-wrapper\">\n                    <product-card\n                      product={this.buyTogetherData.productMain}\n                      paymentOptions={this.buyTogetherData.productMain.paymentOptions}\n                    ></product-card>\n                    {this.buyTogetherData.productMain.selectVariations && (\n                      <variation-selector\n                        productId={this.buyTogetherData.productMain.id}\n                        onInputSelect={ev => this.onInputSelectProductMain(ev)}\n                        variations={this.buyTogetherData.productMain.selectVariations}\n                      ></variation-selector>\n                    )}\n                  </div>\n                </div>\n              )}\n              {!this.showcaseMode && (\n                <div class=\"plus-icon\">\n                  <img src={getAssetPath('./assets/icons/icon-plus.svg')} alt=\"\" />\n                </div>\n              )}\n              <div class={`products-order-bump ${this.showcaseModeClass()}`}>\n                {this.buyTogetherData.products.map(productCard => (\n                  <div class=\"product-wrapper\">\n                    <div class=\"product-wrapper-pivot\">\n                      <div class=\"checkbox-wrapper\">\n                        <input\n                          type=\"checkbox\"\n                          checked={productCard.isCheck}\n                          id={String(productCard.id)}\n                          onInput={ev => this.selectOrderBump(ev, productCard.id)}\n                        />\n                      </div>\n                      <product-card\n                        inline\n                        product={productCard}\n                        paymentOptions={productCard.paymentOptions}\n                      ></product-card>\n                    </div>\n                    {productCard.selectVariations && (\n                      <variation-selector\n                        productId={productCard.id}\n                        variations={productCard.selectVariations}\n                        onInputSelect={ev => this.onInputSelectOrderBump(ev)}\n                        showcaseMode={this.showcaseMode}\n                      ></variation-selector>\n                    )}\n                  </div>\n                ))}\n              </div>\n              <div class={`buy-btn-wrapper ${this.showcaseModeClass()}`}>\n                <button\n                  class=\"buy-btn\"\n                  type=\"submit\"\n                  disabled={this.isAddingToCart || !this.formIsValid}\n                >\n                  {this.buyButtonText || 'Comprar'}\n                </button>\n              </div>\n            </section>\n          </form>\n        )}\n      </Host>\n    );\n  }\n}\n"]}