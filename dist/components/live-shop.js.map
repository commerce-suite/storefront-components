{"file":"live-shop.js","mappings":"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","names":["LiveShop"],"sources":["src/components/live-shop/services/live-shop.service.ts","src/components/live-shop/live-shop.scss?tag=live-shop","src/components/live-shop/live-shop.tsx"],"sourcesContent":["import { LiveShopService, ProductService } from '@uxshop/storefront-core';\nimport { LiveShop } from '@uxshop/storefront-core/dist/modules/live-shop/LiveShopTypes';\nimport { IHighlightCardItem } from '../../../components';\nimport { IImage } from '../../ui/product-card/product-card.type';\nimport { IMessageItem, IProductItem } from '../../ui/highlight-card/highlight-card.type';\n\nexport class LiveShopHandler {\n  private liveShopData: LiveShop;\n\n  private async getProducts() {\n    const productIds = this.liveShopData.products.map(product => product.productId);\n    return await ProductService.getList({\n      fields: ['name', 'images { src }', 'price', 'priceCompare', 'id', 'slug'],\n      filter: { productIds },\n    });\n  }\n\n  async getLiveShop(hashRoom: string): Promise<LiveShop> {\n    this.liveShopData = await LiveShopService.getByHash(hashRoom);\n    console.log('ðŸš€ ~ LiveShopHandler ~ getLiveShop ~ liveShopData:', this.liveShopData);\n    return this.liveShopData;\n  }\n\n  async productsToItemsAdapter(): Promise<IProductItem[]> {\n    const products = await this.getProducts();\n    return products.edges.map(({ node }) => ({\n      id: +node.id,\n      name: node.name,\n      image: (node.images[0] as IImage) ?? null,\n      price: node.price,\n      priceBase: node.priceCompare,\n      title: '',\n      content: '',\n      type: 'product',\n      highlight: false,\n      slug: node.slug,\n    }));\n  }\n\n  messagesToItemsAdapter(): IMessageItem[] {\n    return this.liveShopData.messages.map(message => ({\n      id: message.id ?? null,\n      title: message.title,\n      content: message.content,\n      type: 'message',\n      highlight: false,\n    }));\n  }\n\n  async getItems(): Promise<IHighlightCardItem[]> {\n    const productItems = await this.productsToItemsAdapter();\n    const messageItems = this.messagesToItemsAdapter();\n    return [...productItems, ...messageItems];\n  }\n}\n","@import '../../style/mixins/button.scss';\n@import '../../style/mixins/spinner-loading.scss';\n\n:host {\n  display: block;\n  width: 100%;\n}\n\n.loading-container {\n  display: flex;\n  width: 100%;\n  justify-content: center;\n  align-items: center;\n  min-height: 350px;\n\n  .spinner {\n    @include lds-dual-ring;\n  }\n}\n\n.live-shop {\n  height: 100%;\n\n  &-warmup {\n    .banner-custom-style {\n      padding: 40px;\n\n      > .custom-card-content {\n        width: 100%;\n        max-width: 720px;\n        height: auto;\n        aspect-ratio: 16 / 9;\n\n        & img {\n          width: 100%;\n          height: 100%;\n          object-fit: cover;\n        }\n\n        .live-shop-banner {\n          background-color: #d9d9d9;\n          height: 100%;\n          width: 100%;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n        }\n      }\n    }\n  }\n\n  &-finished {\n    .button-custom-style {\n      padding: 40px;\n      max-width: 410px;\n      margin: 0 auto;\n      text-align: center;\n\n      & button {\n        @include front-button;\n        font-weight: 500;\n        text-transform: capitalize;\n        font-size: 14px;\n      }\n    }\n  }\n}\n","import { Component, Event, Host, EventEmitter, h, State, Prop } from '@stencil/core';\nimport { ILiveShop } from './live-shop.type';\nimport { IHighlightCardItem } from '../../components';\nimport { LiveShopHandler } from './services/live-shop.service';\n\n@Component({\n  tag: 'live-shop',\n  styleUrl: 'live-shop.scss',\n  shadow: false,\n})\nexport class LiveShop {\n  @Prop() hashRoom: string;\n  @State() videoId: string;\n  @State() isSmallDevice: boolean = window.innerWidth <= 1024;\n  @State() isChatOpen: boolean = false;\n  @State() isLoading: boolean = true;\n  @State() liveShopRegister: ILiveShop;\n  @State() liveShopItemsService: LiveShopHandler;\n  @State() liveShopItems: IHighlightCardItem[];\n\n  @Event({ bubbles: true, eventName: 'on-return-to-home' })\n  onReturnToHome: EventEmitter<void>;\n\n  @Event() componentRendered: EventEmitter<void>;\n\n  private handleResize = () => {\n    this.isSmallDevice = window.innerWidth <= 1024;\n  };\n\n  private isChatOpenHandler = () => {\n    this.isChatOpen = !this.isChatOpen;\n  };\n\n  disconnectedCallback() {\n    window.removeEventListener('resize', this.handleResize);\n  }\n\n  async componentDidLoad() {\n    try {\n      if (!this.hashRoom) throw new Error('Hash Room is required');\n      this.isLoading = true;\n      window.addEventListener('resize', this.handleResize);\n      this.componentRendered.emit();\n      this.liveShopItemsService = new LiveShopHandler();\n      this.liveShopRegister = await this.liveShopItemsService.getLiveShop(this.hashRoom);\n      this.liveShopItems = await this.liveShopItemsService.getItems();\n      if (this.liveShopRegister) this.videoId = this.liveShopRegister.urlLive.split('v=')[1];\n    } catch (error) {\n      console.error(error);\n    } finally {\n      this.isLoading = false;\n    }\n  }\n\n  private renderLoading() {\n    return (\n      <div class=\"loading-container\">\n        <span class=\"spinner\" />\n      </div>\n    );\n  }\n\n  private renderWarmup() {\n    return (\n      <div class=\"live-shop-warmup\">\n        <custom-card customClass=\"banner-custom-style\" cardTitle={this.liveShopRegister.title}>\n          {this.liveShopRegister.banner ? (\n            <img src={this.liveShopRegister.banner.src} alt={this.liveShopRegister.banner.alt} />\n          ) : (\n            <div class=\"live-shop-banner\" />\n          )}\n        </custom-card>\n      </div>\n    );\n  }\n\n  private renderInLive() {\n    return this.isSmallDevice ? (\n      <live-shop-mobile\n        videoId={this.videoId}\n        liveShopData={this.liveShopRegister}\n        items={this.liveShopItems}\n      ></live-shop-mobile>\n    ) : (\n      <live-shop-desktop\n        videoId={this.videoId}\n        liveShopData={this.liveShopRegister}\n        items={this.liveShopItems}\n        isChatOpen={this.isChatOpen}\n        toggleChat={() => this.isChatOpenHandler()}\n      />\n    );\n  }\n\n  private renderFinished() {\n    return (\n      <div class=\"live-shop-finished\">\n        <custom-card\n          customClass=\"button-custom-style\"\n          cardTitle=\"A live chegou ao fim!\"\n          cardDescription=\"Fique de olho em nossas prÃ³ximas lives para mais novidades e promoÃ§Ãµes imperdÃ­veis!\"\n        >\n          <button onClick={() => this.onReturnToHome.emit()}>Voltar para a pÃ¡gina inicial</button>\n        </custom-card>\n      </div>\n    );\n  }\n\n  render() {\n    if (this.isLoading) {\n      return <Host>{this.renderLoading()}</Host>;\n    }\n\n    return (\n      <Host>\n        <div class=\"live-shop\">\n          {this.liveShopRegister.status === 'warmup' && this.renderWarmup()}\n          {this.liveShopRegister.status === 'inLive' && this.renderInLive()}\n          {this.liveShopRegister.status === 'finished' && this.renderFinished()}\n        </div>\n      </Host>\n    );\n  }\n}\n"],"version":3}